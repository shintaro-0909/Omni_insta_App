Claude Rules :look👀

# 🤖 自動監視システム セットアップガイド

> **一度設定すれば、毎日完全自動でヘルスチェック！**  
> **設定時間**: 30分  
> **効果**: 毎朝自動で健康状態をDiscord/メールで受信

---

## 🎯 **自動化されること**

✅ **毎日朝9時に自動実行**
- ウェブサイトのアクセシビリティチェック
- セキュリティ脆弱性スキャン
- 重要ファイルの存在確認
- 健康状態レポート自動生成

✅ **問題発生時の自動通知**
- Discord/Slackに即座にアラート
- 重大問題時はメール通知
- GitHub Actions上で詳細ログ確認可能

✅ **履歴管理**
- 30日分のレポート自動保存
- 傾向分析が可能

---

## 🚀 **セットアップ手順（30分）**

### ステップ1: Discord Webhook設定（10分）

#### 1-1. Discordサーバー準備
```
1. Discordで監視専用サーバーを作成（または既存サーバー使用）
2. 「#omniy-monitoring」チャンネルを作成
3. チャンネル設定 > 連携サービス > Webhookを作成
4. Webhook URLをコピー（後で使用）
```

#### 1-2. Webhook URLの例
```
https://discord.com/api/webhooks/1234567890/ABCDEFGHIJKLMNOPQRSTUVWXYZ
```

### ステップ2: GitHub Secrets設定（10分）

#### 2-1. GitHubリポジトリでSecrets設定
```
1. GitHub > あなたのリポジトリ > Settings
2. 左メニュー > Secrets and variables > Actions
3. 「New repository secret」で以下を追加:
```

#### 2-2. 必要なSecrets
```yaml
DISCORD_WEBHOOK:
  値: https://discord.com/api/webhooks/...（ステップ1のURL）

# メール通知用（Gmailの場合）
EMAIL_USERNAME:
  値: your-gmail@gmail.com

EMAIL_PASSWORD:
  値: アプリパスワード（後述）

ALERT_EMAIL:
  値: 通知を受け取るメールアドレス
```

### ステップ3: Gmail アプリパスワード設定（10分）

#### 3-1. Googleアカウント設定
```
1. Google アカウント > セキュリティ
2. 2段階認証プロセスを有効化（まだの場合）
3. アプリパスワード > メール用パスワード生成
4. 生成された16文字パスワードをEMAIL_PASSWORDに設定
```

#### 3-2. セキュリティ注意点
```
⚠️ アプリパスワードは専用アカウント使用推奨
⚠️ 通知専用のGmailアカウント作成がベスト
⚠️ メインアカウントは使用しない
```

---

## 📱 **使用方法**

### **完全自動（推奨）**
```
設定完了後は何もする必要なし！

毎朝9時に:
📱 Discord に健康状態が自動投稿
📧 問題があれば即座にメール通知
📊 GitHub Actions で詳細ログ確認可能
```

### **手動実行（必要時のみ）**
```
1. GitHub > Actions > "Daily Health Check"
2. "Run workflow" ボタンをクリック
3. 即座にヘルスチェック実行
```

---

## 📊 **通知サンプル**

### **正常時のDiscord通知**
```
🏥 Omniy Daily Health Check
全体状況: ✅ 正常

詳細:
🌐 サイト: ✅ 正常
📁 構造: ✅ 正常  
🔒 セキュリティ: ✅ 安全 / ✅ 安全

おはようございます！今日も快調です 🎉
```

### **問題発生時のDiscord通知**
```
🏥 Omniy Daily Health Check
全体状況: ❌ 要対応

詳細:
🌐 サイト: ❌ エラー (HTTP: 500)
📁 構造: ✅ 正常
🔒 セキュリティ: ⚠️ 3件の脆弱性 / ✅ 安全

⚠️ 至急確認が必要です
```

### **重大問題時のメール通知**
```
件名: 🚨 Omniy Critical Issue Detected

Omniyに重要な問題が検出されました。

全体状況: ❌ 要対応

詳細:
- サイト状況: ❌ エラー (HTTP: 500)
- ファイル構造: ✅ 正常

早急な確認をお願いします。
```

---

## 🔧 **カスタマイズ設定**

### **実行時間の変更**
```yaml
# .github/workflows/daily-health-check.yml の変更
schedule:
  # 朝9時 → 朝6時に変更する場合
  - cron: '0 21 * * *'  # UTC時間 (JST-9時間)
```

### **チェック間隔の変更**
```yaml
# 毎日 → 12時間ごとに変更
- cron: '0 */12 * * *'

# 毎日 → 週1回（月曜日）に変更  
- cron: '0 0 * * 1'
```

### **Slack通知への変更**
```yaml
# Discord → Slack に変更する場合
- name: Send notification (Slack)
  uses: 8398a7/action-slack@v3
  with:
    status: ${{ job.status }}
    webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

---

## 🛠️ **トラブルシューティング**

### **通知が来ない場合**
```
1. GitHub Actions が実行されているか確認
   → Actions タブで実行履歴をチェック

2. Discord Webhook が正しいか確認
   → Webhook URLを再度確認・テスト

3. Secrets が正しく設定されているか確認
   → Settings > Secrets で値を再確認
```

### **メール通知が来ない場合**
```
1. Gmailアプリパスワードが正しいか確認
2. 2段階認証が有効になっているか確認  
3. 受信メールの迷惑メールフォルダを確認
```

### **GitHub Actions が失敗する場合**
```
1. firebase.json が正しい場所にあるか確認
2. package.json が frontend/ と functions/ にあるか確認
3. Actions の詳細ログで具体的なエラーを確認
```

---

## 💡 **運用のコツ**

### **効果的な使い方**
```
✅ 朝のコーヒーと一緒にDiscord確認
✅ 問題があれば即座に対応（朝の時間帯）
✅ 週末に詳細レポートをレビュー
✅ 月次で監視設定の見直し
```

### **アラート疲れ防止**
```
⚠️ 軽微な警告は即座に対応（積み重ねを防ぐ）
⚠️ 同じ問題が続く場合は根本原因を調査
⚠️ 不要なアラートは設定を調整
```

---

## 🎉 **設定完了後の効果**

### **日常が変わります**
```
設定前:
😰 毎朝手動でチェック
😰 問題発見が遅れがち
😰 週末も気になって確認

設定後:  
😊 完全自動で朝一に状況把握
😊 問題があれば即座に通知
😊 安心して週末を過ごせる
```

### **運用負荷**
```
設定前: 毎日5分 × 365日 = 30時間/年
設定後: 月1回5分 × 12回 = 1時間/年

年間29時間の節約！ 🎉
```

---

この自動監視システムで、**完全に手ぶらで運用**できるようになります！

**困った時は**: このガイドの「トラブルシューティング」セクションをご確認ください。