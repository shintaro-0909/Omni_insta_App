# Omniy éšœå®³å¯¾å¿œæ‰‹é †æ›¸

æœ€çµ‚æ›´æ–°æ—¥: 2025å¹´1æœˆ27æ—¥

## ğŸ¯ ç›®çš„

æœ¬æ–‡æ›¸ã¯ã€Omniy Instagramè‡ªå‹•æŠ•ç¨¿ã‚µãƒ¼ãƒ“ã‚¹ã§ç™ºç”Ÿã™ã‚‹éšœå®³ãƒ»ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã«å¯¾ã™ã‚‹æ¨™æº–çš„ãªå¯¾å¿œæ‰‹é †ã‚’å®šç¾©ã—ã€è¿…é€Ÿã‹ã¤åŠ¹æœçš„ãªå¾©æ—§ã‚’å›³ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚

## ğŸ“‹ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡

### Severity 1 (Critical) - ç·Šæ€¥
- **å®šç¾©**: ã‚µãƒ¼ãƒ“ã‚¹å…¨åœæ­¢ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¾µå®³ã€ãƒ‡ãƒ¼ã‚¿æå¤±
- **å¯¾å¿œæ™‚é–“**: 15åˆ†ä»¥å†…ã«å¯¾å¿œé–‹å§‹
- **å¾©æ—§ç›®æ¨™**: 1æ™‚é–“ä»¥å†…
- **ä¾‹**: 
  - å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„
  - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Œå…¨åœæ­¢
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¾µå®³ã®æ¤œçŸ¥

### Severity 2 (High) - é«˜
- **å®šç¾©**: ä¸»è¦æ©Ÿèƒ½ã®éšœå®³ã€å¤§é‡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å½±éŸ¿
- **å¯¾å¿œæ™‚é–“**: 30åˆ†ä»¥å†…ã«å¯¾å¿œé–‹å§‹
- **å¾©æ—§ç›®æ¨™**: 4æ™‚é–“ä»¥å†…
- **ä¾‹**:
  - InstagramæŠ•ç¨¿æ©Ÿèƒ½ãŒå…¨ãå‹•ä½œã—ãªã„
  - æ±ºæ¸ˆå‡¦ç†ã‚¨ãƒ©ãƒ¼
  - Cloud Functionså¤§è¦æ¨¡éšœå®³

### Severity 3 (Medium) - ä¸­
- **å®šç¾©**: ä¸€éƒ¨æ©Ÿèƒ½ã®éšœå®³ã€é™å®šçš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿
- **å¯¾å¿œæ™‚é–“**: 2æ™‚é–“ä»¥å†…ã«å¯¾å¿œé–‹å§‹
- **å¾©æ—§ç›®æ¨™**: 8æ™‚é–“ä»¥å†…
- **ä¾‹**:
  - ç‰¹å®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æŠ•ç¨¿å¤±æ•—
  - UIè¡¨ç¤ºã®ä¸å…·åˆ
  - é€šçŸ¥ãƒ¡ãƒ¼ãƒ«é…å»¶

### Severity 4 (Low) - ä½
- **å®šç¾©**: è»½å¾®ãªä¸å…·åˆã€å›é¿ç­–ãŒå­˜åœ¨
- **å¯¾å¿œæ™‚é–“**: ç¿Œå–¶æ¥­æ—¥ã«å¯¾å¿œé–‹å§‹
- **å¾©æ—§ç›®æ¨™**: 72æ™‚é–“ä»¥å†…
- **ä¾‹**:
  - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã®è»½å¾®ãªå´©ã‚Œ
  - éé‡è¦ãªãƒ­ã‚°ã‚¨ãƒ©ãƒ¼

---

## ğŸš¨ ç·Šæ€¥å¯¾å¿œãƒ•ãƒ­ãƒ¼ (Severity 1-2)

### å¯¾å¿œãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

```mermaid
graph TD
    A[ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿ] --> B{è‡ªå‹•æ¤œçŸ¥?}
    B -->|Yes| C[ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥]
    B -->|No| D[ãƒ¦ãƒ¼ã‚¶ãƒ¼å ±å‘Š/å†…éƒ¨ç™ºè¦‹]
    
    C --> E[Severityåˆ¤å®š]
    D --> E
    
    E --> F{Severity 1-2?}
    F -->|Yes| G[ç·Šæ€¥å¯¾å¿œãƒãƒ¼ãƒ å¬é›†]
    F -->|No| H[é€šå¸¸å¯¾å¿œãƒ•ãƒ­ãƒ¼]
    
    G --> I[åˆæœŸå¯¾å¿œé–‹å§‹]
    I --> J[å½±éŸ¿ç¯„å›²ç¢ºèª]
    J --> K[ä¸€æ™‚å¯¾å¿œå®Ÿæ–½]
    K --> L[ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥]
    L --> M[æ ¹æœ¬å¯¾å¿œ]
    M --> N[å¾©æ—§ç¢ºèª]
    N --> O[äº‹å¾Œåˆ†æ]
    
    H --> P[ç¿Œå–¶æ¥­æ—¥å¯¾å¿œ]
```

### Step 1: åˆæœŸå¯¾å¿œï¼ˆ0-15åˆ†ï¼‰

#### 1.1 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆæ¤œçŸ¥
- **è‡ªå‹•ç›£è¦–**: Google Cloud Monitoring ã‚¢ãƒ©ãƒ¼ãƒˆ
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼å ±å‘Š**: ã‚µãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ« (support@omniy.jp)
- **å†…éƒ¨ç™ºè¦‹**: é–‹ç™ºãƒãƒ¼ãƒ ãƒ»é‹ç”¨ãƒãƒ¼ãƒ 

#### 1.2 ç·Šæ€¥é€£çµ¡
```bash
# ç·Šæ€¥æ™‚é€£çµ¡å…ˆï¼ˆSeverity 1ã®å ´åˆï¼‰
- ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…: [phone] [email]
- é–‹ç™ºè²¬ä»»è€…: [phone] [email]
- çµŒå–¶é™£: [phone] [email]
```

#### 1.3 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
- **GitHub Issues**: ç·Šæ€¥ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç”¨ãƒ©ãƒ™ãƒ« "incident:critical"
- **Slack**: #incident-response ãƒãƒ£ãƒ³ãƒãƒ«
- **Google Sheets**: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆè¨˜éŒ²ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ

### Step 2: çŠ¶æ³ç¢ºèªï¼ˆ15-30åˆ†ï¼‰

#### 2.1 å½±éŸ¿ç¯„å›²ç¢ºèª
```bash
# ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèªã‚³ãƒãƒ³ãƒ‰
firebase emulators:start # ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ãƒ†ã‚¹ãƒˆ
gcloud compute instances list --project=omniy-prod
gcloud functions list --project=omniy-prod
```

#### 2.2 ãƒ­ã‚°ç¢ºèª
```bash
# Cloud Functions ãƒ­ã‚°
gcloud functions logs read --project=omniy-prod
# Firestore ç›£æŸ»ãƒ­ã‚°
gcloud logging read "resource.type=gce_instance" --project=omniy-prod
# ã‚¨ãƒ©ãƒ¼ç‡çµ±è¨ˆ
gcloud monitoring metrics list --project=omniy-prod
```

#### 2.3 å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ³
- **Firebase Status**: https://status.firebase.google.com/
- **Instagram Graph API**: https://developers.facebook.com/status/
- **Stripe Status**: https://status.stripe.com/

### Step 3: åˆæœŸå¯¾å¿œï¼ˆ30-60åˆ†ï¼‰

#### 3.1 ä¸€æ™‚å¾©æ—§æªç½®
```bash
# ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
gcloud functions deploy postExecutor --project=omniy-prod
# ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼è¨­å®šå¤‰æ›´
gcloud compute backend-services update --project=omniy-prod
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
gcloud compute url-maps invalidate-cdn-cache --project=omniy-prod
```

#### 3.2 å›é¿ç­–å®Ÿè£…
- **æ©Ÿèƒ½ã®ä¸€æ™‚ç„¡åŠ¹åŒ–**: éšœå®³æ©Ÿèƒ½ã®ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°OFF
- **ä»£æ›¿æ‰‹æ®µæç¤º**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®æ‰‹å‹•æŠ•ç¨¿æ¡ˆå†…
- **è² è·è»½æ¸›**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®ä¸€æ™‚å¼·åŒ–

### Step 4: ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ï¼ˆ60åˆ†ä»¥å†…ï¼‰

#### 4.1 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸æ›´æ–°
```markdown
# éšœå®³é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
**[éšœå®³å ±å‘Š] InstagramæŠ•ç¨¿æ©Ÿèƒ½ã«é–¢ã™ã‚‹éšœå®³ã«ã¤ã„ã¦**

ç™ºç”Ÿæ™‚åˆ»: 2025-01-27 14:30 JST
å½±éŸ¿ç¯„å›²: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®Instagramè‡ªå‹•æŠ•ç¨¿æ©Ÿèƒ½
ç¾åœ¨ã®çŠ¶æ³: èª¿æŸ»ä¸­
äºˆæƒ³å¾©æ—§æ™‚åˆ»: 16:00 JSTï¼ˆäºˆå®šï¼‰

ãŠå®¢æ§˜ã«ã¯ã”è¿·æƒ‘ã‚’ãŠã‹ã‘ã—ã€æ·±ããŠè©«ã³ç”³ã—ä¸Šã’ã¾ã™ã€‚
å¾©æ—§æ¬¡ç¬¬ã€æ”¹ã‚ã¦ã”å ±å‘Šã„ãŸã—ã¾ã™ã€‚
```

#### 4.2 é€šçŸ¥æ–¹æ³•
- **Webã‚µã‚¤ãƒˆ**: ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãƒãƒŠãƒ¼
- **ãƒ¡ãƒ¼ãƒ«**: å½±éŸ¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ä¸€æ–‰é€ä¿¡
- **SNS**: Twitter @OmniyApp ã§ã®çŠ¶æ³å ±å‘Š

---

## ğŸ”§ å…·ä½“çš„ãªéšœå®³å¯¾å¿œæ‰‹é †

### ã‚±ãƒ¼ã‚¹1: Cloud Functions éšœå®³

#### ç—‡çŠ¶
- HTTP 500ã‚¨ãƒ©ãƒ¼å¤šç™º
- æŠ•ç¨¿å®Ÿè¡Œã®å®Œå…¨åœæ­¢
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ API ã‚¨ãƒ©ãƒ¼

#### å¯¾å¿œæ‰‹é †
```bash
# 1. ãƒ­ã‚°ç¢ºèª
gcloud functions logs read postExecutor --limit=50

# 2. é–¢æ•°ã®çŠ¶æ…‹ç¢ºèª
gcloud functions describe postExecutor

# 3. å†ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
cd functions
npm run build
firebase deploy --only functions:postExecutor

# 4. å‹•ä½œç¢ºèª
curl -X POST https://us-central1-omniy-prod.cloudfunctions.net/postExecutor
```

#### æ ¹æœ¬åŸå› èª¿æŸ»
- ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå±¥æ­´ã®ç¢ºèª
- ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå¤‰æ›´ã®å½±éŸ¿
- ãƒ¡ãƒ¢ãƒªãƒ»ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šã®è¦‹ç›´ã—

### ã‚±ãƒ¼ã‚¹2: Firestore æ¥ç¶šéšœå®³

#### ç—‡çŠ¶
- ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
- èªè¨¼å¤±æ•—
- æŠ•ç¨¿å±¥æ­´ãŒè¡¨ç¤ºã•ã‚Œãªã„

#### å¯¾å¿œæ‰‹é †
```bash
# 1. Firestoreæ¥ç¶šãƒ†ã‚¹ãƒˆ
firebase emulators:start --only firestore

# 2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ç¢ºèª
firebase firestore:rules:get

# 3. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹çŠ¶æ³ç¢ºèª
firebase firestore:indexes

# 4. æ¥ç¶šè¨­å®šä¿®å¾©
firebase use omniy-prod
firebase deploy --only firestore:rules
```

#### ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ç¢ºèª
```javascript
// Firestore ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
const admin = require('firebase-admin');
admin.initializeApp();
const db = admin.firestore();

async function checkDataIntegrity() {
  const users = await db.collection('users').get();
  const schedules = await db.collection('schedules').get();
  
  console.log(`Users: ${users.size}, Schedules: ${schedules.size}`);
  
  // å­¤ç«‹ã—ãŸã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
  for (const schedule of schedules.docs) {
    const userId = schedule.data().userId;
    const userExists = await db.collection('users').doc(userId).get();
    if (!userExists.exists) {
      console.log(`Orphaned schedule: ${schedule.id}`);
    }
  }
}
```

### ã‚±ãƒ¼ã‚¹3: Instagram Graph API éšœå®³

#### ç—‡çŠ¶
- æŠ•ç¨¿ãŒã™ã¹ã¦å¤±æ•—
- "Invalid access token" ã‚¨ãƒ©ãƒ¼
- API ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼

#### å¯¾å¿œæ‰‹é †
```bash
# 1. Instagram API çŠ¶æ³ç¢ºèª
curl -X GET "https://graph.instagram.com/me?access_token=ACCESS_TOKEN"

# 2. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°
# functions/src/api/igAccounts.ts ã® refreshInstagramToken å®Ÿè¡Œ

# 3. APIåˆ¶é™çŠ¶æ³ç¢ºèª
# Graph API Explorer ã§ç¾åœ¨ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’ç¢ºèª

# 4. æŠ•ç¨¿ã‚­ãƒ¥ãƒ¼ã®ä¸€æ™‚åœæ­¢
# postExecutor.ts ã§å®Ÿè¡Œã‚’ä¸€æ™‚åœæ­¢
```

#### ä»£æ›¿å¯¾å¿œ
- æ‰‹å‹•æŠ•ç¨¿ã®æ¡ˆå†…ãƒ¡ãƒ¼ãƒ«é€ä¿¡
- æŠ•ç¨¿äºˆå®šã®å»¶æœŸã‚ªãƒ—ã‚·ãƒ§ãƒ³æä¾›
- APIå¾©æ—§å¾Œã®è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤è¨­å®š

### ã‚±ãƒ¼ã‚¹4: Stripeæ±ºæ¸ˆéšœå®³

#### ç—‡çŠ¶
- æ±ºæ¸ˆå‡¦ç†ã®å¤±æ•—
- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ›´æ–°ã‚¨ãƒ©ãƒ¼
- Webhook å—ä¿¡å¤±æ•—

#### å¯¾å¿œæ‰‹é †
```bash
# 1. Stripe ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç¢ºèª
# https://dashboard.stripe.com/

# 2. Webhook ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¢ºèª
curl -X POST https://us-central1-omniy-prod.cloudfunctions.net/stripeWebhook

# 3. å¤±æ•—ã—ãŸæ±ºæ¸ˆã®æ‰‹å‹•å‡¦ç†
# Stripe CLI ã§ã®æ±ºæ¸ˆçŠ¶æ³ç¢ºèª
stripe charges list --limit=10

# 4. ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³çŠ¶æ…‹ä¿®å¾©
# functions/src/api/stripe.ts ã§ã®æ‰‹å‹•åŒæœŸå®Ÿè¡Œ
```

---

## ğŸ“Š å¾©æ—§å¾Œã®å¯¾å¿œ

### å„é‡è¦åº¦ãƒ¬ãƒ™ãƒ«ã®å¯¾å¿œä¾‹

#### Severity 1 (Critical) å¯¾å¿œä¾‹

**ã‚·ãƒŠãƒªã‚ª**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„
```yaml
æ¤œçŸ¥æ™‚åˆ»: 14:30
åˆæœŸå¯¾å¿œ: 14:35 (5åˆ†)
  - Firebase AuthçŠ¶æ…‹ç¢ºèª
  - Google Cloud Consoleç¢ºèª
  - ç·Šæ€¥é€£çµ¡å®Ÿæ–½

å½±éŸ¿ç¢ºèª: 14:40 (10åˆ†)
  - å½±éŸ¿ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ (500å)
  - ãƒ“ã‚¸ãƒã‚¹å½±éŸ¿: å£²ä¸Šåœæ­¢ã€ä¿¡é ¼å¤±å¢œãƒªã‚¹ã‚¯

ä¸€æ™‚å¯¾å¿œ: 14:50 (20åˆ†)
  - Firebase Authè¨­å®šãƒªã‚»ãƒƒãƒˆ
  - ä»£æ›¿èªè¨¼æ–¹æ³•ã®æ¤œè¨
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥æº–å‚™

å¾©æ—§ä½œæ¥­: 15:00 (30åˆ†)
  - è¨­å®šä¿®æ­£ã¨å†ãƒ‡ãƒ—ãƒ­ã‚¤
  - æ®µéšçš„å¾©æ—§ç¢ºèª
  - ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°å¼·åŒ–

å®Œå…¨å¾©æ—§: 15:30 (60åˆ†)
  - å…¨æ©Ÿèƒ½å¾©æ—§ç¢ºèª
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥å®Œäº†
  - äº‹å¾Œåˆ†æé–‹å§‹
```

#### Severity 2 (High) å¯¾å¿œä¾‹

**ã‚·ãƒŠãƒªã‚ª**: InstagramæŠ•ç¨¿æ©Ÿèƒ½ãŒå…¨ãå‹•ä½œã—ãªã„
```yaml
æ¤œçŸ¥æ™‚åˆ»: 10:00
åˆæœŸå¯¾å¿œ: 10:20 (20åˆ†)
  - Cloud Functions ãƒ­ã‚°ç¢ºèª
  - Instagram APIçŠ¶æ…‹ç¢ºèª
  - é–‹ç™ºãƒãƒ¼ãƒ å¬é›†

å½±éŸ¿ç¢ºèª: 10:40 (40åˆ†)
  - å½±éŸ¿æ©Ÿèƒ½: è‡ªå‹•æŠ•ç¨¿ã€æ‰‹å‹•æŠ•ç¨¿
  - å½±éŸ¿ãƒ¦ãƒ¼ã‚¶ãƒ¼: æœ‰æ–™ãƒ—ãƒ©ãƒ³å…¨å“¡ (100å)

ä¸€æ™‚å¯¾å¿œ: 11:00 (60åˆ†)
  - æ‰‹å‹•æŠ•ç¨¿æ¡ˆå†…ãƒ¡ãƒ¼ãƒ«é€ä¿¡
  - APIæ¥ç¶šå†è©¦è¡Œ
  - æŠ•ç¨¿ã‚­ãƒ¥ãƒ¼ä¸€æ™‚åœæ­¢

å¾©æ—§ä½œæ¥­: 12:00 (120åˆ†)
  - ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°
  - é–¢æ•°å†ãƒ‡ãƒ—ãƒ­ã‚¤
  - æ®µéšçš„æ©Ÿèƒ½å¾©æ—§

å®Œå…¨å¾©æ—§: 14:00 (240åˆ†)
  - æŠ•ç¨¿æ©Ÿèƒ½å¾©æ—§
  - ä¿ç•™æŠ•ç¨¿ã®å†å®Ÿè¡Œ
  - ãŠè©«ã³ãƒ¡ãƒ¼ãƒ«é€ä¿¡
```

#### Severity 3 (Medium) å¯¾å¿œä¾‹

**ã‚·ãƒŠãƒªã‚ª**: ç‰¹å®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æŠ•ç¨¿å¤±æ•—
```yaml
æ¤œçŸ¥æ™‚åˆ»: 09:00
åˆæœŸå¯¾å¿œ: 11:00 (2æ™‚é–“)
  - è©²å½“ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç‰¹å®š
  - ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°åé›†
  - å½±éŸ¿ç¯„å›²ç¢ºèª

èª¿æŸ»å®Ÿæ–½: 13:00 (4æ™‚é–“)
  - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®šç¢ºèª
  - ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æ€§ç¢ºèª
  - APIåˆ¶é™ç¢ºèª

ä¿®æ­£å¯¾å¿œ: 15:00 (6æ™‚é–“)
  - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå†èªè¨¼
  - è¨­å®šä¿®æ­£
  - å‹•ä½œç¢ºèª

å®Œäº†å ±å‘Š: 17:00 (8æ™‚é–“)
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼å€‹åˆ¥é€£çµ¡
  - è£œå„Ÿå¯¾å¿œï¼ˆå¿…è¦æ™‚ï¼‰
  - ãƒŠãƒ¬ãƒƒã‚¸æ›´æ–°
```

### é€£çµ¡å…ˆã¨Escalationæ‰‹é †

#### å†…éƒ¨é€£çµ¡ä½“åˆ¶
```yaml
Level 1 - é–‹ç™ºãƒãƒ¼ãƒ :
  - å¯¾å¿œæ™‚é–“: å¹³æ—¥ 9:00-18:00
  - é€£çµ¡æ–¹æ³•: Slack #dev-team
  - å¯¾å¿œç¯„å›²: æŠ€è¡“çš„å•é¡Œå…¨èˆ¬

Level 2 - ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…:
  - å¯¾å¿œæ™‚é–“: 24æ™‚é–“ (ã‚ªãƒ³ã‚³ãƒ¼ãƒ«)
  - é€£çµ¡æ–¹æ³•: 
    - å„ªå…ˆ: æºå¸¯é›»è©± 080-XXXX-XXXX
    - äºˆå‚™: emergency@omniy.jp
  - å¯¾å¿œç¯„å›²: ã‚¤ãƒ³ãƒ•ãƒ©éšœå®³ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

Level 3 - çµŒå–¶é™£:
  - å¯¾å¿œæ™‚é–“: 24æ™‚é–“ (Severity 1ã®ã¿)
  - é€£çµ¡æ–¹æ³•: 
    - sh: 090-XXXX-XXXX
    - ç·Šæ€¥ä¼šè­°: Google Meet (URLå›ºå®š)
  - å¯¾å¿œç¯„å›²: äº‹æ¥­ç¶™ç¶šæ€§åˆ¤æ–­

å¤–éƒ¨é€£çµ¡å…ˆ:
  - Firebase Support: 
    - Email: firebase-support@google.com
    - Priority: P1ãƒã‚±ãƒƒãƒˆä½œæˆ
  - Stripe Support:
    - Dashboard: https://dashboard.stripe.com/support
    - ç·Šæ€¥: +1-888-889-xxxx
  - Instagram/Meta:
    - Developer Support: https://developers.facebook.com/support/
```

#### EscalationåŸºæº–
```yaml
è‡ªå‹•Escalationæ¡ä»¶:
  - å¯¾å¿œé–‹å§‹é…å»¶: SLAæ™‚é–“ã®50%çµŒé
  - å¾©æ—§é…å»¶: ç›®æ¨™æ™‚é–“è¶…é
  - å½±éŸ¿æ‹¡å¤§: å½“åˆæƒ³å®šã®2å€ä»¥ä¸Š
  - è¿½åŠ éšœå®³: é–¢é€£ã‚·ã‚¹ãƒ†ãƒ ã¸ã®æ³¢åŠ

åˆ¤æ–­åŸºæº–:
  - ãƒ‡ãƒ¼ã‚¿æå¤±ãƒªã‚¹ã‚¯ â†’ å³åº§ã«Level 3
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¾µå®³ â†’ å³åº§ã«Level 3
  - å£²ä¸Šå½±éŸ¿ > Â¥100,000 â†’ Level 2
  - ãƒ¡ãƒ‡ã‚£ã‚¢éœ²å‡ºãƒªã‚¹ã‚¯ â†’ Level 3
```

### Step 1: æ ¹æœ¬åŸå› åˆ†æï¼ˆRCAï¼‰

#### åˆ†æé …ç›®
- **ç™ºç”ŸåŸå› **: æŠ€è¡“çš„è¦å› ã€äººçš„è¦å› ã€å¤–éƒ¨è¦å› 
- **æ¤œçŸ¥æ™‚é–“**: ã‚¢ãƒ©ãƒ¼ãƒˆã‹ã‚‰å¯¾å¿œé–‹å§‹ã¾ã§
- **å¾©æ—§æ™‚é–“**: å¯¾å¿œé–‹å§‹ã‹ã‚‰å®Œå…¨å¾©æ—§ã¾ã§
- **å½±éŸ¿ç¯„å›²**: å½±éŸ¿ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã€ãƒ‡ãƒ¼ã‚¿æå¤±æœ‰ç„¡

#### RCAãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
```markdown
# ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒ¬ãƒãƒ¼ãƒˆï¼ˆINC-2025-001ï¼‰

## æ¦‚è¦
- ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ ID: INC-2025-001
- ç™ºç”Ÿæ—¥æ™‚: 2025-01-27 14:30:00 JST
- å¾©æ—§æ—¥æ™‚: 2025-01-27 16:15:00 JST
- å½±éŸ¿æ™‚é–“: 1æ™‚é–“45åˆ†
- Severity: 2 (High)

## ç™ºç”ŸçŠ¶æ³
[è©³ç´°ãªçŠ¶æ³èª¬æ˜]

## æ ¹æœ¬åŸå› 
[æŠ€è¡“çš„ãªåŸå› åˆ†æ]

## å¯¾å¿œå†…å®¹
[å®Ÿæ–½ã—ãŸå¯¾å¿œæ‰‹é †]

## å†ç™ºé˜²æ­¢ç­–
[å…·ä½“çš„ãªæ”¹å–„æ–½ç­–]
```

### Step 2: äº‹å¾Œæ”¹å–„

#### æŠ€è¡“çš„æ”¹å–„
- **ç›£è¦–å¼·åŒ–**: æ–°ãŸãªãƒ¡ãƒˆãƒªã‚¯ã‚¹è¿½åŠ 
- **å†—é•·åŒ–**: SPOF (Single Point of Failure) ã®è§£æ¶ˆ
- **è‡ªå‹•åŒ–**: æ‰‹å‹•ä½œæ¥­ã®è‡ªå‹•åŒ–
- **ãƒ†ã‚¹ãƒˆå¼·åŒ–**: éšœå®³ã‚·ãƒŠãƒªã‚ªã®ãƒ†ã‚¹ãƒˆè¿½åŠ 

#### ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„
- **æ¤œçŸ¥æ™‚é–“çŸ­ç¸®**: ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šã®è¦‹ç›´ã—
- **å¯¾å¿œæ™‚é–“çŸ­ç¸®**: å¯¾å¿œæ‰‹é †ã®åŠ¹ç‡åŒ–
- **ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: é€šçŸ¥æ–¹æ³•ã®æ”¹å–„
- **ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰**: å¯¾å¿œæ‰‹é †ã®æ–‡æ›¸åŒ–

---

## ğŸ” ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

### Google Cloud Monitoring

#### Cloud Functions ç›£è¦–
```yaml
# functions-error-rate.yaml
displayName: "Cloud Functions Error Rate"
conditions:
  - displayName: "Error rate > 5%"
    conditionThreshold:
      filter: 'resource.type="cloud_function"'
      comparison: COMPARISON_GREATER_THAN
      thresholdValue: 0.05
      duration: 300s
```

#### Firestore ç›£è¦–
```yaml
# firestore-latency.yaml
displayName: "Firestore Query Latency"
conditions:
  - displayName: "P95 latency > 1000ms"
    conditionThreshold:
      filter: 'resource.type="datastore_database"'
      comparison: COMPARISON_GREATER_THAN
      thresholdValue: 1000
```

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–

#### ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹
```javascript
// functions/src/utils/monitoring.ts
import { Monitoring } from '@google-cloud/monitoring';

const monitoring = new Monitoring.MetricServiceClient();

export async function recordPostExecutionMetric(success: boolean) {
  const request = {
    name: `projects/omniy-prod/metricDescriptors/custom.googleapis.com/post_execution`,
    metricDescriptor: {
      labels: [{ key: 'status', valueType: 'STRING' }],
      metricKind: 'GAUGE',
      valueType: 'INT64'
    }
  };
  
  await monitoring.createTimeSeries({
    name: `projects/omniy-prod`,
    timeSeries: [{
      metric: { type: 'custom.googleapis.com/post_execution' },
      resource: { type: 'global' },
      points: [{
        interval: { endTime: { seconds: Date.now() / 1000 } },
        value: { int64Value: success ? 1 : 0 }
      }]
    }]
  });
}
```

---

## ğŸ“ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### ãƒ¬ãƒ™ãƒ«1: é–‹ç™ºãƒãƒ¼ãƒ 
- **å¯¾å¿œæ™‚é–“**: å¹³æ—¥ 9:00-18:00
- **å¯¾å¿œå†…å®¹**: ä¸€èˆ¬çš„ãªæŠ€è¡“çš„å•é¡Œ
- **é€£çµ¡å…ˆ**: tech@omniy.jp

### ãƒ¬ãƒ™ãƒ«2: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…
- **å¯¾å¿œæ™‚é–“**: 24æ™‚é–“ï¼ˆã‚ªãƒ³ã‚³ãƒ¼ãƒ«ï¼‰
- **å¯¾å¿œå†…å®¹**: ã‚¤ãƒ³ãƒ•ãƒ©éšœå®³ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œ
- **é€£çµ¡å…ˆ**: [ç·Šæ€¥é€£çµ¡å…ˆ]

### ãƒ¬ãƒ™ãƒ«3: çµŒå–¶é™£
- **å¯¾å¿œæ™‚é–“**: 24æ™‚é–“ï¼ˆç·Šæ€¥æ™‚ã®ã¿ï¼‰
- **å¯¾å¿œå†…å®¹**: äº‹æ¥­ç¶™ç¶šæ€§ã«å½±éŸ¿ã™ã‚‹é‡å¤§éšœå®³
- **é€£çµ¡å…ˆ**: [çµŒå–¶é™£ç·Šæ€¥é€£çµ¡å…ˆ]

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [æŠ€è¡“ä»•æ§˜æ›¸](./TECHNICAL_SPECIFICATIONS.md)
- [é‹ç”¨æ‰‹é †æ›¸](./OPERATIONS.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œæ‰‹é †](./SECURITY_INCIDENT_RESPONSE.md)
- [ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚¹ãƒˆã‚¢æ‰‹é †](./BACKUP_RESTORE.md)

---

**ä½œæˆè€…**: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…  
**æ‰¿èªè€…**: CTOã‚  
**æ¬¡å›è¦‹ç›´ã—**: 2025å¹´4æœˆ27æ—¥